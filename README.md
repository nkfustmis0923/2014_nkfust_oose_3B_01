# 資管3B OOSE 第01組 #

## ★ 專題題目： ☆ ##
    Ms 正韓服飾 - 行動應用程式

### ★ 組長： ☆ ###
    ★ 0124036 李承勳

### ★ 組員： ☆ ###
    ★ 0124010  黃湧翔

    ★ 0124020  吳維軒

    ★ 0124092  劉晉維

    ★ 0124104  周顯其

### ★ 專題描述： ☆ ###
　　現今韓國娛樂崛起，大家都極度關注韓國藝人的一舉一動。不只是他們在台上的演出，觀眾們也非常關注藝人的穿著。於是造就韓國服飾業的興起，我們為了搭上這股潮流，於是我們想要設計一個專賣正韓服飾的行動APP，搭載於全球涵蓋率超過80%的Android系統上。

　　下載此軟體的客戶第一次需要註冊成為會員，輸入基本資料後即可使用此行動應用程式。進入系統後可以選購及預覽商品，並透過此軟體來下訂單，並可發出修改訂單需求的訊息來通知主管核准。主管也可透過此應用程式來接收客戶訂單與訊息、管理商品的基本資訊以及掌管庫存量。

### ★ 利害關係人目標表： ☆　###
![default](https://cloud.githubusercontent.com/assets/8871571/4804863/ebcfb3a6-5e73-11e4-939d-95811a3bb84d.png)

### ★ 事件與使用案例表： ☆　###
![default](https://cloud.githubusercontent.com/assets/8871571/4792221/94579aba-5de4-11e4-8e40-73b9eb45b654.png)

### ★ 使用案例圖： ☆　###
![default](https://cloud.githubusercontent.com/assets/8871571/4808297/fe6de32c-5e9e-11e4-8f99-66e343745e33.png)

### ★ 使用案例的描述： ☆　###
![-](https://cloud.githubusercontent.com/assets/8871571/4808210/fd17cb9c-5e9d-11e4-86cc-70c7f93d4a51.png)
![-](https://cloud.githubusercontent.com/assets/8871571/4805198/adba9710-5e79-11e4-9dbe-9c33aa4ff8df.png)
![-](https://cloud.githubusercontent.com/assets/8871571/4805199/b0fc3f14-5e79-11e4-9b14-3d670b48f212.png)
![-](https://cloud.githubusercontent.com/assets/8871571/4805201/b5788426-5e79-11e4-8562-62de8303f934.png)

### ★使用案例的活動圖： ☆　###
##### ★ 服飾基本資料作業活動圖 ☆ #####
![default](https://cloud.githubusercontent.com/assets/8871571/4811324/bb20fc7e-5eb9-11e4-8ecf-91e148923549.png)
##### ★ 客戶基本資料作業活動圖 ☆ #####
![default](https://cloud.githubusercontent.com/assets/8871571/4811320/b75f1710-5eb9-11e4-9b6c-ea713266048b.png)
##### ★ 處理訂單記錄活動圖 ☆ #####
![default](https://cloud.githubusercontent.com/assets/8871571/4811316/ac23ac58-5eb9-11e4-890c-51a2e645b1c2.png)
##### ★ 倉儲管理作業活動圖 ☆ #####
![default](https://cloud.githubusercontent.com/assets/8871571/4811318/b057e244-5eb9-11e4-9d3c-f4a036ba7817.png)

### ★使用案例的名詞與概念類別列舉表： ☆　###
##### ★ 服飾基本資料作業的概念類別☆ #####
![default](https://cloud.githubusercontent.com/assets/8871571/4792256/e4871bf0-5de4-11e4-89e9-d28f2527a4f1.png)
##### ★ 客戶基本資料作業的概念類別☆ #####
![default](https://cloud.githubusercontent.com/assets/8871571/4792257/e7ff34fc-5de4-11e4-9509-15fa50a5667c.png)
##### ★ 處理訂單記錄作業的概念類別☆ #####
![default](https://cloud.githubusercontent.com/assets/8871571/4792258/eb449e5e-5de4-11e4-81d3-c048500770d6.png)
##### ★ 倉儲管理作業的概念類別☆ #####
![default](https://cloud.githubusercontent.com/assets/8871571/4792266/ee00521e-5de4-11e4-8434-9727fb93307b.png)

### ★使用案例的初步類別圖： ☆　###
##### ★ 服飾基本資料作業之類別圖☆ #####
![default](https://cloud.githubusercontent.com/assets/8871571/5336271/e979904e-7ef4-11e4-82fa-38b3d6dea530.png)
##### ★ 客戶基本資料作業之類別圖☆ #####
![default](https://cloud.githubusercontent.com/assets/8871571/5336275/f25d266c-7ef4-11e4-94d1-bd96393c4555.png)
##### ★ 處理訂單記錄作業之類別圖☆ #####
![default](https://cloud.githubusercontent.com/assets/8871571/5336280/07a940c8-7ef5-11e4-8e59-9afda3cf1afb.png)
##### ★ 倉儲管理作業之類別圖 ☆ #####
![default](https://cloud.githubusercontent.com/assets/8871571/5336281/0e8bd3ec-7ef5-11e4-8081-d1b97408dd78.png)

### ★系統類別圖： ☆　###
![default](https://cloud.githubusercontent.com/assets/8871571/5336264/bf425cac-7ef4-11e4-8041-a01aade0dfe3.png)

### ★使用案例主要成功情節之英文名稱事件對應： ☆　###
![-](https://cloud.githubusercontent.com/assets/8871571/4805218/e419d4d8-5e79-11e4-99b4-5b5a66a53938.png)
![-](https://cloud.githubusercontent.com/assets/8871571/4805219/e8283f88-5e79-11e4-8c36-0b3de0488d30.png)
![-](https://cloud.githubusercontent.com/assets/8871571/4805220/eaffb4fc-5e79-11e4-804d-05fa165ea6e1.png)
![-](https://cloud.githubusercontent.com/assets/8871571/4805221/ecb8964c-5e79-11e4-802d-d243a733f2ed.png)

### ★每個名稱事件之合約： ☆　###
##### ★ 服飾基本資料作業名稱事件之合約☆ #####
![default](https://cloud.githubusercontent.com/assets/8871571/4805224/fd8420d6-5e79-11e4-9f38-d377e7fa769b.png)
##### ★ 客戶基本處理資料名稱事件之合約☆ #####
![default](https://cloud.githubusercontent.com/assets/8871571/4792736/fe87cd16-5de8-11e4-9f68-f6a7c8e6f324.png)
##### ★ 處理訂單作業名稱事件之合約☆ #####
![default](https://cloud.githubusercontent.com/assets/8871571/4792737/021fef94-5de9-11e4-82fa-74884275a3e0.png)
##### ★ 倉儲管理作業名稱事件之合約☆ #####
![default](https://cloud.githubusercontent.com/assets/8871571/4792738/0493ecee-5de9-11e4-8b52-973dd892b535.png)

### ★使用案例之系統循序圖： ☆　###
##### ★ 服飾基本資料作業循序圖☆ #####
![default](https://cloud.githubusercontent.com/assets/8871571/4792742/090d6232-5de9-11e4-8798-dbc07750e534.png)
##### ★ 客戶基本資料作業循序圖☆ #####
![default](https://cloud.githubusercontent.com/assets/8871571/4808286/d7dfdb8e-5e9e-11e4-8b97-7b27c2ebb3df.png)
##### ★ 處理訂單紀錄循序圖☆ #####
![default](https://cloud.githubusercontent.com/assets/8871571/4808288/db738e58-5e9e-11e4-9255-a5e0b7c650c6.png)
##### ★ 倉儲管理作業循序圖☆ #####
![default](https://cloud.githubusercontent.com/assets/8871571/4808290/dfd13072-5e9e-11e4-9573-a0a18a9fe58a.png)

### ★ Boundary： ☆　###
![boundary](https://cloud.githubusercontent.com/assets/8871571/5336288/3316c258-7ef5-11e4-958f-cbd99886fc1f.png)
### ★ Control： ☆　###
![control](https://cloud.githubusercontent.com/assets/8871571/5336292/404fc398-7ef5-11e4-9b77-da003d910d2b.png)
### ★ Entity： ☆　###
![entity](https://cloud.githubusercontent.com/assets/8871571/5336297/4347994a-7ef5-11e4-8c59-15351fadb6a9.png)

### ★ 使用案例強韌圖： ☆　###
![default](https://cloud.githubusercontent.com/assets/8871571/5336344/e5730ca4-7ef5-11e4-91ea-8e88fbfb81f1.png)

### ★ ER Model： ☆　###
![er-model](https://cloud.githubusercontent.com/assets/8871571/5515355/c18fef72-88a1-11e4-9ed7-bdbced14b397.png)

## ★ 程式碼展示： ☆　##
### ★ 介面設計： ☆　###
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical"
    tools:context=".MyActivity">


    <SearchView
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:id="@+id/searchView"
        android:layout_gravity="center_horizontal"
        />
    <ScrollView
        android:id="@+id/scroller"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:clickable="false">
        <LinearLayout
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:orientation="vertical"
            android:id="@+id/linearLayout"

            android:weightSum="1">



            <ImageView
                android:id="@+id/hyorin"
                android:layout_width="match_parent"
                android:layout_height="250dp"
                android:scaleType="fitXY"
                android:src="@drawable/man" />

            <ListView

                android:layout_width="match_parent"
                android:layout_height="190dp"
                android:id="@+id/listView2"
                android:visibility="gone"
                android:choiceMode="none"
                android:smoothScrollbar="false"
                android:drawSelectorOnTop="false"
                 />



            <ImageView
                android:id="@+id/bora"
                android:layout_width="match_parent"
                android:layout_height="250dp"
                android:scaleType="fitXY"
                android:src="@drawable/jacket"

                />
            <ListView
                android:layout_width="match_parent"
                android:layout_height="190dp"
                android:id="@+id/listView3"
                android:layout_gravity="center_horizontal"
                android:visibility="gone"
                android:choiceMode="none" />
            <ImageView
                android:id="@+id/soyou"
                android:layout_width="match_parent"
                android:layout_height="250dp"
                android:scaleType="fitXY"
                android:src="@drawable/cloth1"

                />
            <ListView
                android:layout_width="match_parent"
                android:layout_height="190dp"
                android:id="@+id/listView4"
                android:layout_gravity="center_horizontal"
                android:visibility="gone"
                android:choiceMode="none" />
            <ImageView
                android:id="@+id/dasom"
                android:layout_width="match_parent"
                android:layout_height="250dp"
                android:scaleType="fitXY"
                android:src="@drawable/paint"

                />
            <ListView
                android:layout_width="match_parent"
                android:layout_height="190dp"
                android:id="@+id/listView5"
                android:layout_gravity="center_horizontal"
                android:visibility="gone"
                android:choiceMode="none"
                />



        </LinearLayout>

    </ScrollView>

</LinearLayout>

### ★ 圖片頁面： ☆　###
<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:id="@+id/container"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    >

<LinearLayout
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical"
    >
    <RelativeLayout
        android:layout_width="match_parent"
        android:layout_height="45dp"
        android:background="#ffd7ffe1">
        <TextView
            android:layout_width="wrap_content"
            android:layout_height="45dp"
            android:id="@+id/text1"
            android:text="    灰色拉鍊針織領大衣          NT$6990元"
            android:textSize="16dp"
            android:gravity="center" />
        <ImageView
            android:layout_width="wrap_content"
            android:layout_height="38dp"
            android:src="@drawable/shoppingcart"
            android:layout_toRightOf="@+id/text1"
            android:layout_marginTop="3dp"
            android:layout_marginLeft="3dp"
            android:gravity="center|right"

            />

    </RelativeLayout>
    <HorizontalScrollView

        android:layout_width="wrap_content"
        android:layout_height="180dp"

        android:background="#aa44081f"
        android:scrollbars="none">

        <LinearLayout


            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:orientation="horizontal"
            android:background="#ffebfffa">

            <ImageButton
                android:id="@+id/image6"
                android:layout_width="140dp"
                android:layout_height="160dp"
                android:layout_alignParentTop="true"
                android:layout_centerHorizontal="true"
                android:layout_margin="8dp"
                android:scaleType="centerCrop"
                android:src="@drawable/coat11"/>
            <ImageButton
                android:id="@+id/image2"
                android:layout_width="140dp"
                android:layout_height="160dp"
                android:layout_alignParentTop="true"
                android:layout_centerHorizontal="true"
                android:layout_margin="8dp"
                android:scaleType="centerCrop"
                android:src="@drawable/coat22"
                />
            <ImageButton
                android:id="@+id/image3"
                android:layout_width="140dp"
                android:layout_height="160dp"
                android:layout_alignParentTop="true"
                android:layout_centerHorizontal="true"
                android:layout_margin="8dp"
                android:scaleType="centerCrop"
                android:src="@drawable/coat33"
                />

            <ImageButton
                android:id="@+id/image4"
                android:layout_width="140dp"
                android:layout_height="160dp"
                android:layout_alignParentTop="true"
                android:layout_centerHorizontal="true"
                android:layout_margin="8dp"
                android:scaleType="centerCrop"
                android:src="@drawable/coat44"/>
            <ImageButton
                android:id="@+id/image5"
                android:layout_width="140dp"
                android:layout_height="160dp"
                android:layout_alignParentTop="true"
                android:layout_centerHorizontal="true"
                android:layout_margin="8dp"
                android:scaleType="centerCrop"
                android:src="@drawable/coat55"/>

        </LinearLayout>

    </HorizontalScrollView>

    <RelativeLayout
        android:layout_width="match_parent"
        android:layout_height="45dp"
        android:background="#ffd7ffe1">
        <TextView
            android:layout_width="wrap_content"
            android:layout_height="45dp"
            android:id="@+id/text2"
            android:text="          針織領灰色大衣             NT$6990元"
            android:textSize="16dp"
            android:gravity="center" />
        <ImageView
            android:layout_width="wrap_content"
            android:layout_height="38dp"
            android:src="@drawable/shoppingcart"
            android:layout_toRightOf="@+id/text2"
            android:layout_marginTop="3dp"
            android:layout_marginLeft="3dp"
            android:gravity="center|right"

            />

    </RelativeLayout>

</LinearLayout>

    <ImageView
        android:id="@+id/image"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:layout_gravity="center"
        android:visibility="invisible"
        android:scaleType="centerCrop"
        android:adjustViewBounds="false" />

</FrameLayout>

### ★ 主頁面： ☆　###
package com.example.user.hello;

import android.app.ActionBar;
import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.view.Menu;
import android.view.MenuItem;
import android.view.View;
import android.widget.AdapterView;
import android.widget.ArrayAdapter;


import android.widget.ImageView;
import android.widget.ListView;
import android.widget.ScrollView;



public class MyActivity extends Activity {
    String[] singerdata;
    String[] singerdata2;
    String[] singerdata3;
    String[] singerdata4;

    int mCount;
    int mCount2;
    int mCount3;
    int mCount4;
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_my);

        final ScrollView scroller=(ScrollView)findViewById(R.id.scroller);
        final ImageView image1=(ImageView)findViewById(R.id.hyorin);
        final ImageView image2=(ImageView)findViewById(R.id.bora);
        final ImageView image3=(ImageView)findViewById(R.id.soyou);
        final ImageView image4=(ImageView)findViewById(R.id.dasom);

        final ListView list1=(ListView)findViewById(R.id.listView2);
        final ListView list2=(ListView)findViewById(R.id.listView3);
        final ListView list3=(ListView)findViewById(R.id.listView4);
        final ListView list4=(ListView)findViewById(R.id.listView5);

        singerdata=new String[]{"大衣和風衣","夾克外套"};
        singerdata2=new String[]{"襯衫","T恤","帽T","休閒衫","針織毛衣"};
        singerdata3=new String[]{"短褲","長褲","牛仔褲"};
        singerdata4=new String[]{"簡歷","單曲","MV","照片"};
        mCount=0;
        mCount2=0;
        mCount3=0;
        mCount4=0;
        ArrayAdapter<String> ArrayData=new ArrayAdapter<String>(this,
                android.R.layout.simple_list_item_checked,singerdata);
        ArrayAdapter<String> ArrayData2=new ArrayAdapter<String>(this,
                android.R.layout.simple_list_item_checked,singerdata2);
        ArrayAdapter<String> ArrayData3=new ArrayAdapter<String>(this,
                android.R.layout.simple_list_item_checked,singerdata3);
        ArrayAdapter<String> ArrayData4=new ArrayAdapter<String>(this,
                android.R.layout.simple_list_item_checked,singerdata4);
        list1.setAdapter(ArrayData);
        list2.setAdapter(ArrayData2);
        list3.setAdapter(ArrayData3);
        list4.setAdapter(ArrayData4);
list1.setOnItemClickListener(new AdapterView.OnItemClickListener() {
    public void onItemClick(AdapterView<?> arg0, View arg1, int postion, long arg3) {
        Intent intent = null;
        switch (postion) {
            case 0:
                intent = new Intent(arg0.getContext(), show_picture.class);
                break;
            case 1:
                intent=new Intent(arg0.getContext(),VerticalViewPager.class);
                break;
            case 2:
                intent=new Intent(arg0.getContext(),SlidePicture2.class);
                break;
            case 3:
                intent=new Intent(arg0.getContext(),ActivityZoom.class);
                break;
        }
        startActivity(intent);
    }
});
        image1.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View view) {
                mCount++;

                    list1.setVisibility(View.VISIBLE);
                list2.setVisibility(View.GONE);
                list3.setVisibility(View.GONE);
                list4.setVisibility(View.GONE);
                mCount2=0;
                mCount3=0;
                mCount4=0;
                if(mCount%2==0)
                    list1.setVisibility(View.GONE);
            }
        });
        image2.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View view) {
                int[] location = new int[2];
                image2.getLocationInWindow(location);
                int x = location[0];
                int y = location[1];
               scroller.smoothScrollTo(x,y);
                mCount2++;
                mCount=0;
                mCount3=0;
                mCount4=0;

                    list2.setVisibility(View.VISIBLE);
                list1.setVisibility(View.GONE);
                list3.setVisibility(View.GONE);
                list4.setVisibility(View.GONE);

                if(mCount2%2==0)
                    list2.setVisibility(View.GONE);
            }
        });
        image3.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View view) {

                mCount3++;

                mCount2=0;
                mCount=0;
                mCount4=0;
                    list3.setVisibility(View.VISIBLE);
                list1.setVisibility(View.GONE);
                list2.setVisibility(View.GONE);
                list4.setVisibility(View.GONE);

                if(mCount3%2==0)
                    list3.setVisibility(View.GONE);
            }
        });
        image4.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View view) {
                mCount4++;

                mCount2=0;
                mCount3=0;
                mCount=0;
                    list4.setVisibility(View.VISIBLE);
                list1.setVisibility(View.GONE);
                list2.setVisibility(View.GONE);
                list3.setVisibility(View.GONE);
                if(mCount4%2==0)
                    list4.setVisibility(View.GONE);
            }
        });
    }


    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.my, menu);
        return true;
    }

    @Override
    public boolean onOptionsItemSelected(MenuItem item) {
        // Handle action bar item clicks here. The action bar will
        // automatically handle clicks on the Home/Up button, so long
        // as you specify a parent activity in AndroidManifest.xml.
        int id = item.getItemId();
        if (id == R.id.action_settings) {
            return true;
        }
        return super.onOptionsItemSelected(item);
    }
}

### ★ 圖片縮放頁面： ☆　###
package com.example.user.hello;

import android.animation.Animator;
import android.animation.AnimatorListenerAdapter;
import android.animation.AnimatorSet;
import android.animation.ObjectAnimator;
import android.app.Activity;
import android.app.ActionBar;
import android.app.Fragment;
import android.content.res.Resources;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.graphics.Point;
import android.graphics.Rect;
import android.os.Bundle;
import android.view.LayoutInflater;
import android.view.Menu;
import android.view.MenuItem;
import android.view.View;
import android.view.ViewGroup;
import android.os.Build;
import android.view.Window;
import android.view.animation.DecelerateInterpolator;
import android.widget.ImageView;
import android.widget.LinearLayout;
import android.widget.TextView;


public class ActivityZoom extends Activity {
    private LinearLayout mGallery;
    private int[] mImgIds;
    private LayoutInflater mInflater;
    private Animator mCurrentAnimator;
    private int mShortAnimationDuration;
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        requestWindowFeature(Window.FEATURE_NO_TITLE);
        setContentView(R.layout.activity_activity_zoom);



        final View thumb1View=findViewById(R.id.image6);
        thumb1View.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View view) {
                zoomImageFromThumb(thumb1View, R.drawable.coat1);
            }
        });
        final View thumb1View2=findViewById(R.id.image2);
        thumb1View2.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View view) {
                zoomImageFromThumb(thumb1View2, R.drawable.coat2);
            }
        });



        mShortAnimationDuration = getResources().getInteger(
                android.R.integer.config_shortAnimTime);
        mInflater = LayoutInflater.from(this);

    }

 /*   private void initData()
    {
        mImgIds = new int[] { R.drawable.dasom2, R.drawable.soyou2, R.drawable.hyorin6,
                R.drawable.bora2, R.drawable.hyorin};
    }

    private void initView()
    {
        mGallery = (LinearLayout) findViewById(R.id.id_gallery);

        for (int i = 0; i < mImgIds.length; i++)
        {

            View view = mInflater.inflate(R.layout.fragment_activity_zoom,
                    mGallery, false);

            ImageView img = (ImageView) view
                    .findViewById(R.id.id_index_gallery_item_image);
            img.setImageResource(mImgIds[i]);

            mGallery.addView(view);
        }


    } */

    private void zoomImageFromThumb(final View thumbView, int imageResId) {
        if (mCurrentAnimator != null) {
            mCurrentAnimator.cancel();
        }

        final ImageView expandedImageView = (ImageView) findViewById(
                R.id.image);
        expandedImageView.setImageResource(imageResId);

        final Rect startBounds = new Rect();
        final Rect finalBounds = new Rect();
        final Point globalOffset = new Point();

        thumbView.getGlobalVisibleRect(startBounds);
        findViewById(R.id.container).getGlobalVisibleRect(finalBounds, globalOffset);
        startBounds.offset(-globalOffset.x, -globalOffset.y);
        finalBounds.offset(-globalOffset.x, -globalOffset.y);

        float startScale;
        if ((float) finalBounds.width() / finalBounds.height()
                > (float) startBounds.width() / startBounds.height()) {
            startScale = (float) startBounds.height() / finalBounds.height();
            float startWidth = startScale * finalBounds.width();
            float deltaWidth = (startWidth - startBounds.width()) / 2;
            startBounds.left -= deltaWidth;
            startBounds.right += deltaWidth;
        } else {
            startScale = (float) startBounds.width() / finalBounds.width();
            float startHeight = startScale * finalBounds.height();
            float deltaHeight = (startHeight - startBounds.height()) / 2;
            startBounds.top -= deltaHeight;
            startBounds.bottom += deltaHeight;
        }

        thumbView.setAlpha(0f);
        expandedImageView.setVisibility(View.VISIBLE);

        expandedImageView.setPivotX(0f);
        expandedImageView.setPivotY(0f);

        AnimatorSet set = new AnimatorSet();
        set
                .play(ObjectAnimator.ofFloat(expandedImageView, View.X,
                        startBounds.left, finalBounds.left))
                .with(ObjectAnimator.ofFloat(expandedImageView, View.Y,
                        startBounds.top, finalBounds.top))
                .with(ObjectAnimator.ofFloat(expandedImageView, View.SCALE_X,
                        startScale, 1f)).with(ObjectAnimator.ofFloat(expandedImageView,
                View.SCALE_Y, startScale, 1f));
        set.setDuration(mShortAnimationDuration);
        set.setInterpolator(new DecelerateInterpolator());
        set.addListener(new AnimatorListenerAdapter() {
            @Override
            public void onAnimationEnd(Animator animation) {
                mCurrentAnimator = null;
            }

            @Override
            public void onAnimationCancel(Animator animation) {
                mCurrentAnimator = null;
            }
        });
        set.start();
        mCurrentAnimator = set;

        final float startScaleFinal = startScale;
        expandedImageView.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View view) {
                if (mCurrentAnimator != null) {
                    mCurrentAnimator.cancel();
                }

                AnimatorSet set = new AnimatorSet();
                set.play(ObjectAnimator
                        .ofFloat(expandedImageView, View.X, startBounds.left))
                        .with(ObjectAnimator
                                .ofFloat(expandedImageView,
                                        View.Y, startBounds.top))
                        .with(ObjectAnimator
                                .ofFloat(expandedImageView,
                                        View.SCALE_X, startScaleFinal))
                        .with(ObjectAnimator
                                .ofFloat(expandedImageView,
                                        View.SCALE_Y, startScaleFinal));
                set.setDuration(mShortAnimationDuration);
                set.setInterpolator(new DecelerateInterpolator());
                set.addListener(new AnimatorListenerAdapter() {
                    @Override
                    public void onAnimationEnd(Animator animation) {
                        thumbView.setAlpha(1f);
                        expandedImageView.setVisibility(View.GONE);
                        mCurrentAnimator = null;
                    }

                    @Override
                    public void onAnimationCancel(Animator animation) {
                        thumbView.setAlpha(1f);
                        expandedImageView.setVisibility(View.GONE);
                        mCurrentAnimator = null;
                    }
                });
                set.start();
                mCurrentAnimator = set;
            }
        });
    }
}
